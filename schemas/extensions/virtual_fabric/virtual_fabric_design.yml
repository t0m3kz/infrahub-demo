---
version: "1.0"

nodes:
  - name: VirtualFabricDesign
    namespace: Topology
    description: Design pattern defining resource limits for virtual fabric
    label: "Virtual Fabric Design Pattern"
    icon: "mdi:cloud-outline"
    include_in_menu: true
    menu_placement: "ManagedGeneric"
    uniqueness_constraints:
      - [name__value]
    human_friendly_id:
      - name__value
    display_label: "{{name__value}}"
    order_by: [name__value]
    attributes:
      - name: name
        kind: Text
        unique: true
        order_weight: 100
        description: "Design name ('Small', 'Medium', 'Large', 'Enterprise')"
      - name: description
        kind: Text
        optional: true
        order_weight: 150
        description: "Description of this design pattern"

      # Network Segmentation Limits
      - name: maximum_network_segments
        order_weight: 200
        label: "Maximum Network Segments"
        kind: Number
        default_value: 10
        optional: false
        parameters:
          min_value: 1
          max_value: 500
        description: "Maximum number of isolated network segments (VRFs/VLANs)"

      - name: maximum_vlans_per_segment
        order_weight: 250
        label: "Maximum VLANs per Segment"
        kind: Number
        default_value: 10
        optional: false
        parameters:
          min_value: 1
          max_value: 100
        description: "Maximum VLANs allowed within a single network segment"

      # IP Address Management
      - name: maximum_ip_prefixes
        order_weight: 300
        label: "Maximum IP Prefixes"
        kind: Number
        default_value: 20
        optional: false
        parameters:
          min_value: 1
          max_value: 5000
        description: "Maximum number of IP prefix allocations"

      - name: maximum_ipv4_prefixes
        order_weight: 310
        label: "Maximum IPv4 Prefixes"
        kind: Number
        default_value: 15
        optional: false
        parameters:
          min_value: 1
          max_value: 4000
        description: "Maximum IPv4 prefix allocations"

      - name: maximum_ipv6_prefixes
        order_weight: 320
        label: "Maximum IPv6 Prefixes"
        kind: Number
        default_value: 5
        optional: false
        parameters:
          min_value: 0
          max_value: 1000
        description: "Maximum IPv6 prefix allocations"

      # External Connectivity
      - name: maximum_external_connections
        order_weight: 400
        label: "Maximum External Connections"
        kind: Number
        default_value: 2
        optional: false
        parameters:
          min_value: 1
          max_value: 32
        description: "Maximum external peering connections"

      - name: maximum_bgp_sessions
        order_weight: 450
        label: "Maximum BGP Sessions"
        kind: Number
        default_value: 4
        optional: false
        parameters:
          min_value: 0
          max_value: 100
        description: "Maximum BGP peering sessions"

      - name: maximum_static_routes
        order_weight: 460
        label: "Maximum Static Routes"
        kind: Number
        default_value: 50
        optional: false
        parameters:
          min_value: 0
          max_value: 10000
        description: "Maximum static route entries"

      # Service Endpoints
      - name: maximum_load_balancers
        order_weight: 500
        label: "Maximum Load Balancers"
        kind: Number
        default_value: 2
        optional: false
        parameters:
          min_value: 0
          max_value: 20
        description: "Maximum load balancer instances"

      - name: maximum_virtual_ips
        order_weight: 550
        label: "Maximum Virtual IPs"
        kind: Number
        default_value: 10
        optional: false
        parameters:
          min_value: 0
          max_value: 500
        description: "Maximum virtual IP addresses (VIPs)"

      # Security Policies
      - name: maximum_firewall_rules
        order_weight: 600
        label: "Maximum Firewall Rules"
        kind: Number
        default_value: 100
        optional: false
        parameters:
          min_value: 10
          max_value: 10000
        description: "Maximum firewall rule entries"

      - name: maximum_acl_entries
        order_weight: 650
        label: "Maximum ACL Entries"
        kind: Number
        default_value: 100
        optional: false
        parameters:
          min_value: 10
          max_value: 5000
        description: "Maximum access control list entries"

      - name: maximum_security_zones
        order_weight: 700
        label: "Maximum Security Zones"
        kind: Number
        default_value: 5
        optional: false
        parameters:
          min_value: 1
          max_value: 50
        description: "Maximum security zone definitions"

      # Bandwidth & QoS
      - name: maximum_bandwidth_mbps
        order_weight: 800
        label: "Maximum Bandwidth (Mbps)"
        kind: Number
        default_value: 1000
        optional: false
        parameters:
          min_value: 10
          max_value: 100000
        description: "Maximum aggregate bandwidth in Mbps"

      - name: maximum_qos_policies
        order_weight: 850
        label: "Maximum QoS Policies"
        kind: Number
        default_value: 5
        optional: false
        parameters:
          min_value: 1
          max_value: 50
        description: "Maximum Quality of Service policy definitions"

      # Compute Resources (if applicable)
      - name: maximum_endpoints
        order_weight: 900
        label: "Maximum Endpoints"
        kind: Number
        default_value: 100
        optional: false
        parameters:
          min_value: 1
          max_value: 10000
        description: "Maximum connected endpoints (servers, VMs, containers)"

      - name: maximum_multicast_groups
        order_weight: 950
        label: "Maximum Multicast Groups"
        kind: Number
        default_value: 10
        optional: false
        parameters:
          min_value: 0
          max_value: 500
        description: "Maximum multicast group memberships"

      # Service Features
      - name: supports_encryption
        order_weight: 1000
        label: "Supports Encryption"
        kind: Boolean
        default_value: true
        description: "Whether this tier supports encryption (VPN, IPSEC)"

      - name: supports_multitenancy
        order_weight: 1050
        label: "Supports Multi-tenancy"
        kind: Boolean
        default_value: false
        description: "Whether this tier supports multiple sub-tenants"

      - name: supports_anycast
        order_weight: 1100
        label: "Supports Anycast"
        kind: Boolean
        default_value: false
        description: "Whether anycast routing is supported"

      - name: sla_tier
        kind: Dropdown
        order_weight: 1200
        label: "SLA Tier"
        optional: false
        choices:
          - name: bronze
            label: Bronze
            description: "Best effort, 99% uptime"
            color: "#CD7F32"
          - name: silver
            label: Silver
            description: "Standard, 99.9% uptime"
            color: "#C0C0C0"
          - name: gold
            label: Gold
            description: "Premium, 99.95% uptime"
            color: "#FFD700"
          - name: platinum
            label: Platinum
            description: "Mission critical, 99.99% uptime"
            color: "#E5E4E2"
        default_value: silver

extensions:
  nodes:
    - kind: CustomerVirtualFabric
      relationships:
        - name: design_pattern
          peer: TopologyVirtualFabricDesign
          kind: Attribute
          cardinality: one
          identifier: "virtual_fabric__design_pattern"
          order_weight: 1250
          on_delete: no-action
          optional: false
          description: "Design pattern defining resource limits for deployment"
