---
# yaml-language-server: $schema=https://schema.infrahub.app/infrahub/schema/latest.json
version: "1.0"

generics:
  - name: GenericSFP
    namespace: Dcim
    description: Generic base for all Small Form-factor Pluggable (SFP) transceivers.
    label: SFP
    icon: mdi:gpu
    include_in_menu: false
    display_label: "{{form_factor__value}}-{{sfp_type__value}}"
    attributes:
      - name: serial
        kind: Text
        optional: true
        order_weight: 1400
      - name: sfp_type
        kind: Dropdown
        description: "Type of SFP, such as LR, SR, T."
        order_weight: 1100
        optional: false
        choices:
          - name: lr
            label: LR (Long Reach)
            description: Long Reach SFP, suitable for long-distance fiber connections.
            color: "#009933"
          - name: sr
            label: SR (Short Reach)
            description: Short Reach SFP, typically used for short-distance fiber.
            color: "#cc66ff"
          - name: lrm
            label: LRM (Long Reach Multimode)
            description: SFP for multimode fiber over longer distances.
            color: "#3366ff"
          - name: t
            label: T (Twisted Pair)
            description: Copper-based SFP, often used for twisted pair Ethernet.
            color: "#ff9900"
          - name: sr4
            label: SR4 (Short Range 4-lane)
            description: Short Range 4-lane SFP, used for parallel optics.
            color: "#6666ff"
          - name: lr4
            label: LR4 (Long Range 4-lane)
            description: Long Range 4-lane SFP, typically used for longer distances over parallel optics.
            color: "#336699"
          - name: zr
            label: ZR (Extended Reach)
            description: Extended Reach SFP, suitable for distances up to 80km.
            color: "#cc3300"
          - name: er
            label: ER (Extended Reach)
            description: Extended Reach SFP, typically used for 40km distances.
            color: "#ff6600"
          - name: dac
            label: DAC (Direct Attach Copper)
            description: Direct Attach Copper, used for short connections over copper.
            color: "#b35900"
          - name: aoc
            label: AOC (Active Optical Cable)
            description: Active Optical Cable, used for short connections over fiber.
            color: "#6699ff"
      - name: status
        kind: Dropdown
        optional: false
        order_weight: 1300
        default_value: plugged
        choices:
          - name: plugged
            label: Plugged
            description: Plugged into a device's interface.
            color: "#7fbf7f"
          - name: spare
            label: Spare
            description: Stored somewhere as a spare.
            color: "#ffff7f"
          - name: decommissioned
            label: Decommissioned
            description: Decommissioned might be broken or not used anymore.
            color: "#ffd27f"
      - name: form_factor
        kind: Dropdown
        description: "The physical form factor of the SFP module."
        order_weight: 1000
        optional: false
        choices:
          - name: sfp
            label: SFP
            color: "#009933"
          - name: sfp_plus
            label: SFP+
            color: "#cc66ff"
          - name: qsfp
            label: QSFP
            color: "#6666ff"
          - name: qsfp_plus
            label: QSFP+
            color: "#3366ff"
          - name: qsfp28
            label: QSFP28
            color: "#336699"
          - name: qsfp_dd
            label: QSFP-DD
            color: "#ff9900"
          - name: cfp
            label: CFP
            color: "#cc3300"
          - name: cfp2
            label: CFP2
            color: "#ff6600"
          - name: cfp4
            label: CFP4
            color: "#b35900"
          - name: xfp
            label: XFP
            color: "#6699ff"
          - name: sfp56
            label: SFP56
            color: "#9966ff"
          - name: qsfp56
            label: QSFP56
            color: "#9933cc"
          - name: osfp
            label: OSFP
            color: "#0099cc"
    relationships:
      - name: interface
        peer: DcimInterface
        kind: Attribute
        optional: true
        cardinality: one
        order_weight: 1200
      # - name: spare_location
      #   peer: LocationHosting
      #   kind: Attribute
      #   optional: true
      #   cardinality: one
      #   order_weight: 1500
      - name: manufacturer
        peer: OrganizationManufacturer
        cardinality: one
        kind: Attribute
        optional: true
        order_weight: 1350

nodes:
  - name: StandardSFP
    namespace: Dcim
    inherit_from:
      - DcimGenericSFP
    description: Standard SFP module for various types (e.g., LR, SR, T).
    label: Standard SFP
    icon: mdi:gpu
    include_in_menu: false

  - name: BidiSFP
    namespace: Dcim
    inherit_from:
      - DcimGenericSFP
    description: "Bidirectional SFP supporting two wavelengths for single-fiber operation."
    label: Bidirectional SFP
    icon: lineicons:arrow-both-direction-vertical-1
    include_in_menu: false
    attributes:
      - name: wavelength_tx
        label: "Transmit Wavelength (nm)"
        kind: Number
        optional: false
        description: "Transmit wavelength in nm."
        order_weight: 1175
      - name: wavelength_rx
        label: "Receive Wavelength (nm)"
        kind: Number
        optional: false
        description: "Receive wavelength in nm."
        order_weight: 1150

extensions:
  nodes:
    - kind: DcimPhysicalInterface
      relationships:
        - name: plugged_sfp
          peer: DcimGenericSFP
          cardinality: one
          optional: true
    # - kind: LocationHosting
    #   relationships:
    #     - name: spare_sfps
    #       peer: DcimGenericSFP
    #       cardinality: many
    #       optional: true
    - kind: OrganizationManufacturer
      relationships:
        - name: sfps
          label: SFPs
          peer: DcimGenericSFP
          cardinality: many
          optional: true