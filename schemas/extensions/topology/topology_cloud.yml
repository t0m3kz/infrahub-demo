---
version: "1.0"
generics:
  - name: Resource
    namespace: Cloud
    description: Base for cloud resources with common metadata.
    include_in_menu: false
    attributes:
      - name: name
        kind: Text
        order_weight: 100
      - name: description
        kind: Text
        optional: true
        order_weight: 200
      - name: cloud_id
        kind: Text
        optional: true
        order_weight: 300
      - name: status
        kind: Dropdown
        optional: true
        order_weight: 400
        choices:
          - name: active
            label: Active
            description: Resource is active and operational.
            color: "#7FBF7F"
          - name: provisioning
            label: Provisioning
            description: Resource is being provisioned.
            color: "#7f7fff"
          - name: error
            label: Error
            description: Resource is in an error state.
            color: "#ff7f7f"
          - name: retired
            label: Retired
            description: Resource is retired and inactive.
            color: "#BFBFBF"

nodes:
  - name: Cloud
    namespace: Topology
    inherit_from:
      - TopologyDeployment
    include_in_menu: true
    children: TopologyCloudRegion
    uniqueness_constraints:
      - ["name__value"]
    human_friendly_id:
      - name__value
    display_label: "{{ name__value|upper}} CLOUD"

  - name: CloudRegion
    namespace: Topology
    inherit_from:
      - TopologyDeployment
      - TopologyVirtualCircuitLocation
    parent: TopologyCloud
    children: TopologyCloudZone
    human_friendly_id:
      - name__value
    order_by:
      - name__value
    display_label: "{{ name__value|upper }}"
    uniqueness_constraints:
      - ["name__value", "parent"]
    include_in_menu: false
    attributes:
      - name: status
        kind: Dropdown
        label: "Region Status"
        optional: false
        default_value: active
        order_weight: 300
        choices:
          - name: active
            label: Active
            description: "Region is active and operational"
            color: "#7FBF7F"
          - name: provisioning
            label: Provisioning
            description: "Region is being provisioned"
            color: "#FFFF7F"
          - name: maintenance
            label: Maintenance
            description: "Region is under maintenance"
            color: "#FFD27F"
          - name: constrained
            label: Constrained
            description: "Region has capacity constraints"
            color: "#F4CCCC"
          - name: deprecated
            label: Deprecated
            description: "Region is deprecated"
            color: "#BFBFBF"
    relationships:
      - name: location
        peer: LocationMetro
        cardinality: one
        kind: Attribute
        optional: true
        order_weight: 1000
        identifier: "cloud__region__location"
        description: >
          Geographic location mapping for this region

  - name: CloudZone
    namespace: Topology
    inherit_from:
      - TopologyDeployment
    parent: TopologyCloudRegion
    label: Availability Zone
    children: ""
    human_friendly_id:
      - name__value
    display_label: "{{ name__value|upper }}"
    uniqueness_constraints:
      - ["name__value", "parent"]
    include_in_menu: false

  - name: Account
    namespace: Cloud
    label: Cloud Account
    description: Cloud account/subscription/project scoped to a provider.
    include_in_menu: false
    inherit_from:
      - CloudResource
    human_friendly_id:
      - name__value
    order_by:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [provider, account_id__value]
    attributes:
      - name: account_id
        kind: Text
        order_weight: 250
        optional: true
      - name: environment
        kind: Dropdown
        optional: true
        description: Environment classification of this account
        choices:
          - name: production
            label: Production
            description: Production workloads
            color: "#ff7f7f"
          - name: staging
            label: Staging
            description: Pre-production staging environment
            color: "#ffd27f"
          - name: development
            label: Development
            description: Development and testing
            color: "#7fbf7f"
          - name: sandbox
            label: Sandbox
            description: Experimental sandbox environment
            color: "#7f7fff"
        order_weight: 1400
    relationships:
      - name: provider
        peer: OrganizationProvider
        cardinality: one
        optional: false
        order_weight: 600
      - name: owner
        peer: OrganizationCustomer
        cardinality: one
        optional: true
        order_weight: 700

  - name: VirtualNetwork
    namespace: Cloud
    label: Virtual Network
    description: Provider-agnostic virtual network container
    include_in_menu: false
    inherit_from:
      - CloudResource
    human_friendly_id:
      - name__value
    display_label: "{{name__value}}"
    attributes:
      - name: is_shared
        kind: Boolean
        order_weight: 350
        optional: true
      - name: is_default
        label: Default VPC
        kind: Boolean
        default_value: false
        description: Whether this is the default VPC for the account/region
        order_weight: 1500
      - name: dns_support
        label: DNS Support
        kind: Boolean
        default_value: true
        description: Whether DNS resolution is enabled
        order_weight: 1600
      - name: dns_hostnames
        label: DNS Hostnames
        kind: Boolean
        default_value: false
        description: Whether DNS hostnames are enabled for instances
        order_weight: 1700
    relationships:
      - name: account
        peer: CloudAccount
        cardinality: one
        optional: false
        order_weight: 600
      - name: region
        peer: TopologyCloudRegion
        cardinality: one
        order_weight: 650
      - name: cidr_blocks
        label: CIDR Blocks
        peer: IpamPrefix
        cardinality: many
        kind: Attribute
        optional: true
        description: IP address ranges (CIDR blocks) for this virtual network
        order_weight: 1800
      - name: network_segments
        peer: CloudNetworkSegment
        cardinality: many
        kind: Component
        optional: true
        description: Subnets within this virtual network
        order_weight: 2000
    uniqueness_constraints:
      - [account, name__value]

  - name: NetworkSegment
    namespace: Cloud
    label: Network Segment
    description: Network segment (subnet) within a virtual network.
    include_in_menu: false
    inherit_from:
      - PlatformNetworkSegment
      - CloudResource
    human_friendly_id:
      - name__value
    display_label: "{{name__value}}"
    attributes:
      - name: is_public
        kind: Boolean
        optional: true
        order_weight: 350
      - name: auto_assign_public_ip
        label: Auto-assign Public IP
        kind: Boolean
        default_value: false
        description: Automatically assign public IPs to instances in this subnet
        order_weight: 1500
    relationships:
      - name: virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        kind: Parent
        optional: false
        description: Virtual network containing this subnet
        order_weight: 1050
      - name: availability_zone
        peer: TopologyCloudZone
        cardinality: one
        optional: false
        order_weight: 1100
      - name: cidr_block
        label: CIDR Block
        peer: IpamPrefix
        cardinality: one
        kind: Attribute
        optional: true
        description: IP address range (CIDR) for this subnet
        order_weight: 1600
      - name: tags
        peer: BuiltinTag
        optional: true
        cardinality: many
        kind: Attribute
        order_weight: 3000
    uniqueness_constraints:
      - [virtual_network, name__value]

  - name: SecurityGroup
    namespace: Cloud
    description: >-
      Security group defining network access rules.
      Maps to: AWS Security Group, GCP Firewall Rules, Azure NSG.
    label: Security Group
    icon: mdi:shield-lock
    menu_placement: CloudResource
    include_in_menu: false
    inherit_from:
      - CloudResource
    human_friendly_id:
      - name__value
    order_by:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [virtual_network, name__value]
    attributes:
      - name: name
        kind: Text
        unique: true
        description: Name of the security group
        order_weight: 1000
    relationships:
      - name: virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        kind: Attribute
        optional: false
        description: Virtual network this security group belongs to
        order_weight: 1050
      - name: account
        peer: CloudAccount
        cardinality: one
        kind: Attribute
        optional: false
        description: Cloud account owning this security group
        order_weight: 1100

  # --------------------  Compute Instance  --------------------
  - name: Instance
    namespace: Cloud
    description: Virtual machine or compute instance.
    label: Compute Instance
    icon: mdi:server
    menu_placement: CloudResource
    include_in_menu: false
    inherit_from:
      - CloudResource
    human_friendly_id:
      - name__value
    order_by:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [account, cloud_id__value]
    attributes:
      - name: name
        kind: Text
        unique: true
        description: Name of the compute instance
        order_weight: 1000
      - name: instance_type
        label: Instance Type
        kind: Text
        optional: true
        description: Instance size/type (e.g., t3.micro, n1-standard-1)
        order_weight: 1500
      - name: cpu_count
        label: vCPU Count
        kind: Number
        optional: true
        description: Number of virtual CPUs
        order_weight: 1600
      - name: memory_gb
        label: Memory (GB)
        kind: Number
        optional: true
        description: Memory size in gigabytes
        order_weight: 1700
      - name: root_volume_size_gb
        label: Root Volume Size (GB)
        kind: Number
        optional: true
        description: Size of the root/boot volume in gigabytes
        order_weight: 1800
      - name: os_type
        label: Operating System
        kind: Dropdown
        optional: true
        description: Operating system type
        choices:
          - name: linux
            label: Linux
            description: Linux-based operating system
            color: "#ffc61a"
          - name: windows
            label: Windows
            description: Windows operating system
            color: "#0078D4"
          - name: other
            label: Other
            description: Other operating system
            color: "#808080"
        order_weight: 1900
      - name: private_ip
        label: Private IP Address
        kind: IPHost
        optional: true
        description: Primary private IP address
        order_weight: 2000
      - name: public_ip
        label: Public IP Address
        kind: IPHost
        optional: true
        description: Public IP address (if assigned)
        order_weight: 2100
    relationships:
      - name: availability_zone
        peer: TopologyCloudZone
        cardinality: one
        kind: Attribute
        optional: false
        description: Availability  where this instance runs
        order_weight: 1040
      - name: account
        peer: CloudAccount
        cardinality: one
        kind: Attribute
        optional: false
        description: Cloud account owning this instance
        order_weight: 1050
      - name: network_segment
        peer: CloudNetworkSegment
        cardinality: one
        kind: Attribute
        optional: true
        description: Network segment where this instance is deployed
        order_weight: 1100
      - name: security_groups
        peer: CloudSecurityGroup
        cardinality: many
        kind: Attribute
        optional: true
        description: Security groups attached to this instance
        order_weight: 2200
      - name: interfaces
        peer: CloudNetworkInterface
        cardinality: many
        kind: Attribute
        optional: true
        description: Network interfaces attached to this instance
        order_weight: 2300

  # --------------------  Network Interface  --------------------
  - name: NetworkInterface
    namespace: Cloud
    description: Virtual network interface for compute instances.
    label: Network Interface
    icon: mdi:ethernet
    menu_placement: CloudResource
    include_in_menu: false
    inherit_from:
      - CloudResource
    human_friendly_id:
      - name__value
    order_by:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [network_segment, name__value]
    attributes:
      - name: name
        kind: Text
        unique: true
        description: Name of the network interface
        order_weight: 1000
      - name: is_primary
        label: Primary Interface
        kind: Boolean
        default_value: false
        description: Whether this is the primary network interface
        order_weight: 1400
      - name: private_ip
        label: Private IP Address
        kind: IPHost
        optional: true
        description: Primary private IP address assigned to this interface
        order_weight: 1500
      - name: public_ip
        label: Public IP Address
        kind: IPHost
        optional: true
        description: Public IP address (if assigned)
        order_weight: 1600
      - name: mac_address
        label: MAC Address
        kind: Text
        optional: true
        description: MAC address of the network interface
        order_weight: 1700
    relationships:
      - name: instance
        peer: CloudInstance
        cardinality: one
        kind: Attribute
        optional: true
        description: Compute instance this interface is attached to
        order_weight: 1050
      - name: network_segment
        peer: CloudNetworkSegment
        cardinality: one
        kind: Attribute
        optional: false
        description: Subnet this interface is connected to
        order_weight: 1100
      - name: security_groups
        peer: CloudSecurityGroup
        cardinality: many
        kind: Attribute
        optional: true
        description: Security groups applied to this interface
        order_weight: 2000
      - name: ip_addresses
        label: Additional IP Addresses
        peer: IpamIPAddress
        cardinality: many
        kind: Attribute
        optional: true
        description: Additional IP addresses assigned to this interface
        order_weight: 2100

  # --------------------  Internet Gateway  --------------------
  - name: InternetGateway
    namespace: Cloud
    description: Internet gateway for public internet connectivity.
    label: Internet Gateway
    icon: mdi:web
    menu_placement: CloudResource
    include_in_menu: false
    inherit_from:
      - CloudResource
    human_friendly_id:
      - name__value
    order_by:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [virtual_network, name__value]
    attributes:
      - name: name
        kind: Text
        unique: true
        description: Name of the internet gateway
        order_weight: 1000
    relationships:
      - name: virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        kind: Attribute
        optional: false
        description: Virtual network this gateway is attached to
        order_weight: 1050
      - name: account
        peer: CloudAccount
        cardinality: one
        kind: Attribute
        optional: false
        description: Cloud account owning this gateway
        order_weight: 1100

  # --------------------  NAT Gateway  --------------------
  - name: NATGateway
    namespace: Cloud
    description: >
      NAT gateway for outbound internet from private subnets.
      Maps to AWS, Azure, GCP Cloud NAT.
    label: NAT Gateway
    icon: mdi:router-network
    menu_placement: CloudResource
    include_in_menu: false
    inherit_from:
      - CloudResource
    human_friendly_id:
      - name__value
    order_by:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [virtual_network, name__value]
    attributes:
      - name: name
        kind: Text
        unique: true
        description: Name of the NAT gateway
        order_weight: 1000
      - name: public_ip
        label: Public IP Address
        kind: IPHost
        optional: true
        description: Public IP address of the NAT gateway
        order_weight: 1400
    relationships:
      - name: virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        kind: Attribute
        optional: false
        description: Virtual network this NAT gateway belongs to
        order_weight: 1050
      - name: network_segments
        peer: CloudNetworkSegment
        cardinality: many
        kind: Attribute
        optional: false
        description: Subnets served by this NAT gateway
        order_weight: 1100
      - name: account
        peer: CloudAccount
        cardinality: one
        kind: Attribute
        optional: false
        description: Cloud account owning this NAT gateway
        order_weight: 1150

  # --------------------  Route Table  --------------------
  - name: RouteTable
    namespace: Cloud
    description: >-
      Route table defining network routing rules.
      Maps to: AWS Route Table, GCP Routes, Azure Route Table.
    label: Route Table
    icon: mdi:routes
    menu_placement: CloudResource
    inherit_from:
      - CloudResource
    human_friendly_id:
      - name__value
    order_by:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [virtual_network, name__value]
    attributes:
      - name: name
        kind: Text
        unique: true
        description: Name of the route table
        order_weight: 1000
      - name: is_main
        label: Main Route Table
        kind: Boolean
        default_value: false
        description: Whether this is the main/default route table for the VPC
        order_weight: 1400
    relationships:
      - name: virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        kind: Attribute
        optional: false
        description: Virtual network this route table belongs to
        order_weight: 1050
      - name: network_segments
        peer: CloudNetworkSegment
        cardinality: many
        kind: Attribute
        optional: true
        description: Network segments associated with this route table
        order_weight: 2000

  # --------------------  Public/Static IP  --------------------
  - name: PublicIP
    namespace: Cloud
    description: Static/elastic public IP address.
    label: Public IP
    icon: mdi:ip-network-outline
    menu_placement: CloudResource
    include_in_menu: false
    inherit_from:
      - CloudResource
    human_friendly_id:
      - name__value
    order_by:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [account, public_ip__value]
    attributes:
      - name: name
        kind: Text
        unique: true
        description: Name of the Public IP
        order_weight: 1000
      - name: public_ip
        label: Public IP Address
        kind: IPHost
        description: The static public IP address
        order_weight: 1500
    relationships:
      - name: region
        peer: TopologyCloudRegion
        cardinality: one
        kind: Attribute
        optional: false
        description: Cloud region where this elastic IP resides
        order_weight: 1040
      - name: account
        peer: CloudAccount
        cardinality: one
        kind: Attribute
        optional: false
        description: Cloud account owning this Public IP
        order_weight: 1050
      - name: network_interface
        peer: CloudNetworkInterface
        cardinality: one
        kind: Attribute
        optional: true
        description: Network interface this IP is associated with
        order_weight: 1600
      - name: instance
        peer: CloudInstance
        cardinality: one
        kind: Attribute
        optional: true
        description: Instance this IP is associated with
        order_weight: 1700

  - name: LoadBalancer
    namespace: Cloud
    label: Load Balancer
    description: >
      Cloud load balancer (ALB/NLB/ELB/Azure LB/GCP LB)
      hosting multiple listeners.
    include_in_menu: false
    human_friendly_id:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [virtual_network, name__value]
    inherit_from:
      - PlatformLoadBalancer
      - CloudResource
      - CoreArtifactTarget
    relationships:
      - name: virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        optional: false
        order_weight: 600
      - name: network_segments
        peer: CloudNetworkSegment
        cardinality: many
        optional: false
        order_weight: 700
        description: "Subnets where load balancer is deployed"
      - name: security_groups
        peer: CloudSecurityGroup
        cardinality: many
        optional: true
        order_weight: 750
        description: "Security groups attached to load balancer"
      - name: public_ips
        peer: CloudPublicIP
        cardinality: many
        optional: true
        order_weight: 800
        description: "Elastic IPs attached to load balancer"
      - name: vip_services
        peer: ServiceLoadBalancerVIP
        label: Listeners / VIP Services
        cardinality: many
        kind: Component
        optional: true
        order_weight: 2000
        identifier: load_balancer__vip_services
        description: "Listeners (VIP services) hosted on this load balancer"

  - name: Route
    namespace: Cloud
    label: Route
    description: Route entry within a route table.
    include_in_menu: false
    inherit_from:
      - CloudResource
    relationships:
      - name: route_table
        peer: CloudRouteTable
        cardinality: one
        optional: false
        order_weight: 600
      - name: destination
        peer: IpamPrefix
        cardinality: one
        optional: false
        order_weight: 650
      - name: internet_gateway
        peer: CloudInternetGateway
        cardinality: one
        optional: true
        order_weight: 700
      - name: nat_gateway
        peer: CloudNATGateway
        cardinality: one
        optional: true
        order_weight: 750
      - name: instance
        peer: CloudInstance
        cardinality: one
        optional: true
        order_weight: 800
      - name: network_interface
        peer: CloudNetworkInterface
        cardinality: one
        optional: true
        order_weight: 850
    uniqueness_constraints:
      - [route_table, destination]

  - name: Instance
    namespace: Cloud
    label: Cloud Instance
    description: Compute instance in a cloud AZ.
    include_in_menu: false
    inherit_from:
      - CloudResource
    attributes:
      - name: instance_type
        kind: Text
        optional: true
        order_weight: 300
      - name: image
        kind: Text
        optional: true
        order_weight: 350
    relationships:
      - name: account
        peer: CloudAccount
        cardinality: one
        optional: false
        order_weight: 600
      - name: availability_zone
        peer: TopologyCloudZone
        cardinality: one
        optional: false
        order_weight: 650
      - name: network_segment
        peer: CloudNetworkSegment
        cardinality: one
        optional: false
        order_weight: 700
      - name: security_groups
        peer: CloudSecurityGroup
        cardinality: many
        optional: true
        order_weight: 750
      - name: interfaces
        peer: CloudNetworkInterface
        cardinality: many
        optional: true
        order_weight: 800
    uniqueness_constraints:
      - [account, name__value]

  - name: NetworkACL
    namespace: Cloud
    label: Network ACL
    description: Subnet-level network access control list (stateless firewall).
    include_in_menu: false
    inherit_from:
      - CloudResource
    relationships:
      - name: virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        optional: false
        order_weight: 600
      - name: network_segments
        peer: CloudNetworkSegment
        cardinality: many
        optional: true
        order_weight: 700
      - name: security_policies
        peer: SecurityPolicy
        cardinality: many
        optional: true
        order_weight: 800
        description: "Security policies that define ACL rules"
    uniqueness_constraints:
      - [virtual_network, name__value]

  - name: TransitGateway
    namespace: Cloud
    label: Transit Gateway
    description: Multi-region virtual network transit hub for routing.
    include_in_menu: false
    inherit_from:
      - CloudResource
    human_friendly_id:
      - name__value
    attributes:
      - name: default_route_table
        kind: Boolean
        label: "Default Route Table Association"
        optional: true
        default_value: true
        order_weight: 350
      - name: dns_support
        kind: Boolean
        label: "DNS Support"
        optional: true
        default_value: true
        order_weight: 400
      - name: vpn_ecmp_support
        kind: Boolean
        label: "VPN ECMP Support"
        optional: true
        default_value: false
        order_weight: 450
    relationships:
      - name: asn
        peer: RoutingAutonomousSystem
        cardinality: one
        optional: true
        kind: Attribute
        order_weight: 350
      - name: account
        peer: CloudAccount
        cardinality: one
        optional: false
        order_weight: 600
      - name: region
        peer: TopologyCloudRegion
        cardinality: one
        optional: false
        order_weight: 650
      - name: attached_virtual_networks
        peer: CloudVirtualNetwork
        cardinality: many
        optional: true
        order_weight: 700
        description: "Virtual networks attached to this transit gateway"
      - name: bgp_peer_group
        peer: RoutingBGPPeerGroup
        cardinality: one
        optional: true
        kind: Attribute
        order_weight: 750
        description: "BGP peer group for transit gateway"
    uniqueness_constraints:
      - [account, name__value]

  - name: VPNGateway
    namespace: Cloud
    label: VPN Gateway
    description: VPN gateway for site-to-site and client VPN connections.
    include_in_menu: false
    human_friendly_id:
      - name__value
    inherit_from:
      - CloudResource
      - TopologyVirtualCircuitConnectors
    attributes:
      - name: vpn_type
        kind: Dropdown
        order_weight: 300
        optional: false
        choices:
          - name: site_to_site
            label: Site-to-Site
            description: IPsec VPN between sites
            color: "#3498DB"
          - name: client_vpn
            label: Client VPN
            description: Remote access VPN for clients
            color: "#2ECC71"
    relationships:
      - name: asn
        peer: RoutingAutonomousSystem
        cardinality: one
        optional: true
        kind: Attribute
        order_weight: 350
      - name: virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        optional: false
        order_weight: 600
      - name: transit_gateway
        peer: CloudTransitGateway
        cardinality: one
        optional: true
        order_weight: 650
        description: "Transit gateway attachment (if applicable)"
      - name: customer_gateway
        peer: CloudCustomerGateway
        cardinality: one
        optional: true
        order_weight: 700
        description: "Remote customer gateway"
      - name: bgp_peer_group
        peer: RoutingBGPPeerGroup
        cardinality: one
        optional: true
        kind: Attribute
        order_weight: 750
        description: "BGP peer group configuration for VPN tunnels"
    uniqueness_constraints:
      - [virtual_network, name__value]

  - name: CustomerGateway
    namespace: Cloud
    label: Customer Gateway
    description: Customer/remote gateway for VPN connections.
    include_in_menu: false
    inherit_from:
      - CloudResource
    attributes:
      - name: device_type
        kind: Dropdown
        order_weight: 350
        optional: true
        choices:
          - name: cisco
            label: Cisco
          - name: juniper
            label: Juniper
          - name: palo_alto
            label: Palo Alto
          - name: fortinet
            label: Fortinet
          - name: other
            label: Other
    relationships:
      - name: asn
        peer: RoutingAutonomousSystem
        cardinality: one
        optional: false
        kind: Attribute
        order_weight: 300
      - name: account
        peer: CloudAccount
        cardinality: one
        optional: false
        order_weight: 600
      - name: ip_address
        peer: IpamIPAddress
        cardinality: one
        optional: false
        order_weight: 700
      - name: physical_device
        peer: DcimDevice
        cardinality: one
        optional: true
        order_weight: 800
        description: "Physical device representing this customer gateway"
    uniqueness_constraints:
      - [account, name__value]

  - name: VirtualNetworkPeering
    namespace: Cloud
    label: Virtual Network Peering
    description: Direct virtual network peering connection between two networks.
    include_in_menu: false
    inherit_from:
      - CloudResource
    attributes:
      - name: peering_status
        kind: Dropdown
        order_weight: 300
        optional: false
        choices:
          - name: initiating_request
            label: Initiating Request
            color: "#F39C12"
          - name: pending_acceptance
            label: Pending Acceptance
            color: "#FFD27F"
          - name: active
            label: Active
            color: "#7FBF7F"
          - name: rejected
            label: Rejected
            color: "#E74C3C"
          - name: failed
            label: Failed
            color: "#C0392B"
          - name: deleted
            label: Deleted
            color: "#BFBFBF"
    relationships:
      - name: requester_virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        optional: false
        order_weight: 600
        identifier: "cloud_peering_requester"
      - name: accepter_virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        optional: false
        order_weight: 650
        identifier: "cloud_peering_accepter"
      - name: requester_route_table
        peer: CloudRouteTable
        cardinality: one
        optional: true
        order_weight: 700
        identifier: "cloud_peering_requester_rt"
      - name: accepter_route_table
        peer: CloudRouteTable
        cardinality: one
        optional: true
        order_weight: 750
        identifier: "cloud_peering_accepter_rt"
    uniqueness_constraints:
      - [requester_virtual_network, accepter_virtual_network]

  - name: DirectConnect
    namespace: Cloud
    label: Direct Connect
    description: Dedicated physical connection to cloud provider.
    include_in_menu: false
    inherit_from:
      - CloudResource
    attributes:
      - name: bandwidth
        kind: Text
        label: "Bandwidth"
        description: "Connection bandwidth (e.g., 1Gbps, 10Gbps)"
        optional: false
        order_weight: 300
      - name: connection_type
        kind: Dropdown
        order_weight: 350
        optional: false
        choices:
          - name: dedicated
            label: Dedicated
            description: Physical connection at colocation
            color: "#3498DB"
          - name: hosted
            label: Hosted
            description: Hosted connection via partner
            color: "#2ECC71"
      - name: vlan_id
        kind: Number
        label: "VLAN ID"
        optional: true
        order_weight: 400
    relationships:
      - name: account
        peer: CloudAccount
        cardinality: one
        optional: false
        order_weight: 600
      - name: physical_devices
        peer: DcimPhysicalDevice
        cardinality: many
        optional: true
        kind: Attribute
        order_weight: 625
        description: "Physical routers/switches for direct connect"
      - name: region
        peer: TopologyCloudRegion
        cardinality: one
        optional: false
        order_weight: 650
      - name: location
        peer: LocationBuilding
        cardinality: one
        optional: true
        order_weight: 700
        description: "Physical location/data center"
      - name: virtual_interfaces
        peer: CloudVirtualInterface
        cardinality: many
        optional: true
        order_weight: 800
    uniqueness_constraints:
      - [account, name__value]

  - name: VirtualInterface
    namespace: Cloud
    label: Virtual Interface
    description: Virtual interface on Direct Connect/ExpressRoute.
    include_in_menu: false
    inherit_from:
      - CloudResource
    attributes:
      - name: vif_type
        kind: Dropdown
        order_weight: 300
        optional: false
        choices:
          - name: private
            label: Private
            description: Access to virtual network resources
            color: "#3498DB"
          - name: public
            label: Public
            description: Access to public endpoints
            color: "#2ECC71"
          - name: transit
            label: Transit
            description: Transit gateway attachment
            color: "#9B59B6"
      - name: vlan_id
        kind: Number
        label: "VLAN ID"
        optional: false
        order_weight: 350
    relationships:
      - name: asn
        peer: RoutingAutonomousSystem
        cardinality: one
        optional: true
        kind: Attribute
        order_weight: 400
      - name: direct_connect
        peer: CloudDirectConnect
        cardinality: one
        optional: false
        order_weight: 600
      - name: virtual_network
        peer: CloudVirtualNetwork
        cardinality: one
        optional: true
        order_weight: 650
      - name: transit_gateway
        peer: CloudTransitGateway
        cardinality: one
        optional: true
        order_weight: 700
    uniqueness_constraints:
      - [direct_connect, vlan_id__value]
# ==============================================================================
# Extensions - Cloud resources support for load balancer backend pools
# ==============================================================================
extensions:
  nodes:
    - kind: CloudInstance
      relationships:
        - name: backend_pools
          peer: ServiceBackendPool
          label: Backend Pools
          cardinality: many
          optional: true
          order_weight: 2500
          identifier: backend_pool__cloud_instances
          description: "Load balancer backend pools this instance belongs to"
