---
version: "1.0"

nodes:
  - name: Saas
    namespace: Topology
    inherit_from:
      - TopologyDeployment
      - CoreArtifactTarget
    label: SaaS Cloud
    include_in_menu: true
    children: TopologySaasRegion
    uniqueness_constraints:
      - ["name__value"]
    human_friendly_id:
      - name__value
    display_label: "{{ name__value|upper}} SAAS"
    attributes:
      - name: provider
        kind: Dropdown
        label: Provider
        optional: false
        default_value: other
        order_weight: 200
        choices:
          - name: cisco
            label: Cisco
            description: Cisco SaaS (Webex, Umbrella)
            color: "#1BA0D7"
          - name: zoom
            label: Zoom
            description: Zoom conferencing
            color: "#2D8CFF"
          - name: zscaler
            label: Zscaler
            description: Zscaler cloud security
            color: "#0066CC"
          - name: palo_alto
            label: Palo Alto
            description: Palo Alto (Prisma, other)
            color: "#FA582D"
          - name: microsoft
            label: Microsoft
            description: Microsoft cloud apps
            color: "#6264A7"
          - name: salesforce
            label: Salesforce
            description: Salesforce cloud services
            color: "#00A1E0"
          - name: other
            label: Other
            description: Other provider
            color: "#95A5A6"
      - name: service_type
        kind: Dropdown
        label: Service Type
        optional: false
        default_value: other
        order_weight: 300
        choices:
          - name: sase
            label: SASE / SWG
            color: "#3498DB"
          - name: conferencing
            label: Conferencing
            color: "#2ECC71"
          - name: crm
            label: CRM
            color: "#9B59B6"
          - name: storage
            label: Storage
            color: "#F39C12"
          - name: api
            label: API Integration
            color: "#16A085"
          - name: other
            label: Other
            color: "#95A5A6"
      - name: status
        kind: Dropdown
        label: Status
        optional: false
        default_value: active
        order_weight: 400
        choices:
          - name: active
            label: Active
            color: "#7FBF7F"
          - name: provisioning
            label: Provisioning
            color: "#FFFF7F"
          - name: maintenance
            label: Maintenance
            color: "#FFD27F"
          - name: decommissioned
            label: Decommissioned
            color: "#BFBFBF"
      - name: description
        kind: Text
        label: Description
        optional: true
        order_weight: 500

  - name: SaasRegion
    namespace: Topology
    inherit_from:
      - TopologyDeployment
      - TopologyVirtualCircuitLocation
    parent: TopologySaas
    children: ""
    human_friendly_id:
      - region_name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - ["region_name__value"]
    include_in_menu: false
    attributes:
      - name: name
        kind: Text
        computed_attribute:
          kind: Jinja2
          jinja2_template: >
            {{parent__name__value|upper}}-{{region_name__value|upper}}
        read_only: true
        optional: false
      - name: region_name
        kind: Text
        label: "Region Name"
        description: Provider region identifier
        optional: false
        order_weight: 200
      - name: status
        kind: Dropdown
        label: "Region Status"
        optional: false
        default_value: active
        order_weight: 300
        choices:
          - name: active
            label: Active
            description: "Region is active and operational"
            color: "#7FBF7F"
          - name: provisioning
            label: Provisioning
            description: "Region is being provisioned"
            color: "#FFFF7F"
          - name: maintenance
            label: Maintenance
            description: "Region is under maintenance"
            color: "#FFD27F"
          - name: constrained
            label: Constrained
            description: "Region has capacity constraints"
            color: "#F4CCCC"
          - name: deprecated
            label: Deprecated
            description: "Region is deprecated"
            color: "#BFBFBF"
    relationships:
      - name: location
        peer: LocationMetro
        cardinality: one
        kind: Attribute
        optional: true
        order_weight: 1000
        identifier: "saas__region__location"
        description: "Geographic mapping for provider region"

  - name: SaasConnector
    namespace: Topology
    inherit_from:
      - TopologyVirtualCircuitConnectors
    label: SaaS Connector
    human_friendly_id:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [saas_region, name__value]
    include_in_menu: false
    icon: "mdi:connection"
    description: "SaaS connectivity (Cloud Connector)"
    attributes:
      - name: connector_type
        kind: Dropdown
        label: Connector Type
        optional: false
        order_weight: 300
        choices:
          - name: cloud_connector
            label: Cloud Connector
            description: "Native cloud connector (Zscaler CC, Palo Alto CC)"
            color: "#3498DB"
          - name: ipsec_vpn
            label: IPsec VPN
            description: "IPsec VPN tunnel"
            color: "#2ECC71"
          - name: gre_tunnel
            label: GRE Tunnel
            description: "GRE tunnel"
            color: "#9B59B6"
          - name: direct_connect
            label: Direct Connect
            description: "Private direct connection"
            color: "#E74C3C"
          - name: api_endpoint
            label: API Endpoint
            description: "REST/GraphQL API endpoint"
            color: "#F39C12"
          - name: other
            label: Other
            color: "#95A5A6"
      - name: endpoint_url
        kind: Text
        label: "Endpoint URL"
        optional: true
        order_weight: 400
        description: "Connection endpoint URL or IP"
      - name: status
        kind: Dropdown
        optional: false
        order_weight: 500
        default_value: active
        choices:
          - name: active
            label: Active
            color: "#7fbf7f"
          - name: provisioning
            label: Provisioning
            color: "#ffcc00"
          - name: maintenance
            label: Maintenance
            color: "#ff9933"
          - name: decommissioned
            label: Decommissioned
            color: "#cc0000"
      - name: bandwidth_mbps
        kind: Number
        optional: true
        order_weight: 600
        description: "Maximum bandwidth capacity in Mbps"
    relationships:
      - name: saas_region
        peer: TopologySaasRegion
        cardinality: one
        kind: Attribute
        optional: false
        identifier: "saas_connector__region"
        order_weight: 1000
        description: "Parent SaaS region"
