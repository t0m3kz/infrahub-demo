---
version: "1.0"
nodes:
  - name: SiteLayout
    namespace: Topology
    description: "Physical floor plan layout defining data center or colocation space organization"
    label: Site Layout
    icon: "mdi:floor-plan"
    inherit_from:
      - TopologyDesign
    include_in_menu: true
    menu_placement: "TopologyDataCenter"
    human_friendly_id:
      - name__value
    display_label: "{{ name__value }}"
    uniqueness_constraints:
      - [name__value]
    order_by: [name__value]
    attributes:
      - name: description
        kind: Text
        optional: true
        order_weight: 150
        description: "Description of this site layout"
      
      - name: rows
        label: "Number of Rows"
        description: "Total number of rack rows in this layout"
        kind: Number
        optional: false
        order_weight: 1000
        parameters:
          min_value: 1
          max_value: 50
      
      - name: compute_racks_per_row
        label: "Compute Racks per Row"
        description: "Number of compute/server racks per row"
        kind: Number
        optional: false
        order_weight: 1100
        parameters:
          min_value: 0
          max_value: 100
      
      - name: network_racks_per_row
        label: "Network Racks per Row"
        description: "Number of network equipment racks per row"
        kind: Number
        optional: false
        order_weight: 1200
        parameters:
          min_value: 0
          max_value: 50
      
      - name: rack_numbering_scheme
        label: "Rack Numbering Scheme"
        description: "How racks are numbered within this layout"
        kind: Dropdown
        optional: false
        default_value: sequential
        order_weight: 1300
        choices:
          - name: sequential
            label: Sequential
            description: "Racks numbered sequentially 1, 2, 3..."
            color: "#7FBF7F"
          - name: row_based
            label: Row-Based
            description: "Racks numbered by row: R01-01, R01-02, R02-01..."
            color: "#7F7FBF"
          - name: custom
            label: Custom
            description: "Custom numbering scheme defined elsewhere"
            color: "#BF7FBF"
      
      - name: naming_convention
        label: "Device Naming Convention"
        description: "Device naming convention for this site"
        kind: Dropdown
        optional: false
        default_value: standard
        order_weight: 1400
        choices:
          - name: standard
            label: Standard
            description: "Standard device naming (e.g., DC1-1-R01-L01)"
            color: "#7FBF7F"
          - name: hierarchical
            label: Hierarchical
            description: "Hierarchical naming with full path"
            color: "#7F7FBF"
          - name: flat
            label: Flat
            description: "Flat naming without hierarchy"
            color: "#BF7F7F"
      
      - name: total_rack_capacity
        label: "Total Rack Capacity"
        description: "Total number of racks in this layout"
        kind: Text
        computed_attribute:
          kind: Jinja2
          jinja2_template: >
            {{ (rows__value * (compute_racks_per_row__value + network_racks_per_row__value)) }}
        read_only: true
        optional: true
        order_weight: 1400
      
      - name: compute_rack_capacity
        label: "Total Compute Rack Capacity"
        description: "Total compute racks across all rows"
        kind: Text
        computed_attribute:
          kind: Jinja2
          jinja2_template: >
            {{ (rows__value * compute_racks_per_row__value) }}
        read_only: true
        optional: true
        order_weight: 1410
      
      - name: network_rack_capacity
        label: "Total Network Rack Capacity"
        description: "Total network racks across all rows"
        kind: Text
        computed_attribute:
          kind: Jinja2
          jinja2_template: >
            {{ (rows__value * network_racks_per_row__value) }}
        read_only: true
        optional: true
        order_weight: 1420
      
      - name: layout_notes
        label: "Layout Notes"
        description: "Additional notes about physical layout, power, cooling, etc."
        kind: Text
        optional: true
        order_weight: 2000
