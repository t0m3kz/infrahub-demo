---
# Virtual Links (VPN, Direct Connect logical connections)
# Note: Interface bindings are now in 03b_virtual_link_services.yml
apiVersion: infrahub.app/v1
kind: Object
spec:
  kind: TopologyVirtualLink
  data:
    # ===== Frankfurt (FR5) → AWS eu-central-1 =====

    # FR5 → AWS Frankfurt (Direct Connect VIF primary)
    - name: "FR5-to-AWS-FRA-DX-Primary"
      description: "AWS Direct Connect private VIF to eu-central-1"
      link_type: direct_connect_aws
      bandwidth: 10000
      encryption: false
      status: active
      provider: "AWS"
      cloud_resource_id: "dxvif-fh4a7lqd-vif-001"
      source_deployment: "FR5"
      destination_deployment: "eu-central-1"
      underlay_circuit: "dxcon-fh4a7lqd"

    # FR5 → AWS Frankfurt (Direct Connect VIF backup)
    - name: "FR5-to-AWS-FRA-DX-Backup"
      description: "AWS Direct Connect backup VIF to eu-central-1"
      link_type: direct_connect_aws
      bandwidth: 10000
      encryption: false
      status: active
      provider: "AWS"
      cloud_resource_id: "dxvif-fk3b9mpx-vif-001"
      source_deployment: "FR5"
      destination_deployment: "eu-central-1"
      underlay_circuit: "dxcon-fk3b9mpx"

    # ===== Amsterdam (AM5) → AWS eu-west-1 =====

    # AM5 → AWS Ireland (Direct Connect VIF primary)
    - name: "AM5-to-AWS-IRL-DX-Primary"
      description: "AWS Direct Connect private VIF to eu-west-1"
      link_type: direct_connect_aws
      bandwidth: 10000
      encryption: false
      status: active
      provider: "AWS"
      cloud_resource_id: "dxvif-ah7x2npq-vif-001"
      source_deployment: "AM5"
      destination_deployment: "eu-west-1"
      underlay_circuit: "dxcon-ah7x2npq"

    # AM5 → AWS Ireland (Direct Connect VIF backup)
    - name: "AM5-to-AWS-IRL-DX-Backup"
      description: "AWS Direct Connect backup VIF to eu-west-1"
      link_type: direct_connect_aws
      bandwidth: 10000
      encryption: false
      status: active
      provider: "AWS"
      cloud_resource_id: "dxvif-ak9y3prs-vif-001"
      source_deployment: "AM5"
      destination_deployment: "eu-west-1"
      underlay_circuit: "dxcon-ak9y3prs"

    # ===== Cross-Region Direct Connect (FR5 → AWS Ireland) =====

    # FR5 → AWS Ireland (Cross-region failover)
    - name: "FR5-to-AWS-IRL-DX-XRegion"
      description: "Cross-region Direct Connect VIF (failover path)"
      link_type: direct_connect_aws
      bandwidth: 10000
      encryption: false
      status: active
      provider: "AWS"
      cloud_resource_id: "dxvif-cross-region-001"
      source_deployment: "FR5"
      destination_deployment: "eu-west-1"

    # ===== IPsec VPN Backups (Over Internet) =====

    # FR5 → AWS Frankfurt (IPsec VPN backup)
    - name: "FR5-to-AWS-FRA-VPN"
      description: "IPsec VPN backup path from FR5 to eu-central-1"
      link_type: vpn_ipsec
      bandwidth: 10000  # DIA circuit capacity
      encryption: true
      status: active
      provider: "AWS"
      cloud_resource_id: "vpn-fra-0a1b2c3d"
      source_deployment: "FR5"
      destination_deployment: "eu-central-1"
      underlay_circuit: "DIA-FRA-001"

    # AM5 → AWS Ireland (IPsec VPN backup)
    - name: "AM5-to-AWS-IRL-VPN"
      description: "IPsec VPN backup path from AM5 to eu-west-1"
      link_type: vpn_ipsec
      bandwidth: 10000
      encryption: true
      status: active
      provider: "AWS"
      cloud_resource_id: "vpn-irl-5e6f7g8h"
      source_deployment: "AM5"
      destination_deployment: "eu-west-1"
      underlay_circuit: "DIA-AMS-001"

    # DC1 → AWS Frankfurt (Direct VPN - emergency)
    - name: "DC1-to-AWS-FRA-VPN"
      description: "Emergency IPsec VPN from DC1 to AWS"
      link_type: vpn_ipsec
      bandwidth: 1000
      encryption: true
      status: active
      provider: "AWS"
      cloud_resource_id: "vpn-dc1-emergency"
      source_deployment: "DC1"
      destination_deployment: "eu-central-1"

    # ===== Inter-Colocation Virtual Links =====

    # FR5 ↔ AM5 (VXLAN overlay for L2 extension)
    - name: "FR5-AM5-VXLAN-Primary"
      description: "VXLAN tunnel between Frankfurt and Amsterdam"
      link_type: vxlan
      bandwidth: 100000
      encryption: false
      status: active
      provider: "Equinix"
      source_deployment: "FR5"
      destination_deployment: "AM5"
      underlay_circuit: "EQX-METRO-001"

    # FR5 ↔ AM5 (Backup VXLAN)
    - name: "FR5-AM5-VXLAN-Backup"
      description: "Backup VXLAN tunnel between colocations"
      link_type: vxlan
      bandwidth: 100000
      encryption: false
      status: active
      provider: "Equinix"
      source_deployment: "FR5"
      destination_deployment: "AM5"
      underlay_circuit: "EQX-METRO-002"

    # FR5 ↔ AM5 (GRE tunnel for routing)
    - name: "FR5-AM5-GRE"
      description: "GRE tunnel for inter-site routing"
      link_type: gre
      bandwidth: 100000
      encryption: false
      status: active
      provider: "Equinix"
      source_deployment: "FR5"
      destination_deployment: "AM5"
      underlay_circuit: "EQX-METRO-001"

    # ===== Global SD-WAN Overlay =====

    # Global SD-WAN across all sites
    - name: "Global-SD-WAN"
      description: "SD-WAN overlay connecting DC1, FR5, AM5, and AWS regions"
      link_type: sd_wan
      bandwidth: 100000
      encryption: true
      status: active
      provider: "Technology Partner"

    # ===== AWS Inter-Region =====

    # AWS eu-central-1 ↔ eu-west-1 (VPC Peering or Transit Gateway)
    - name: "AWS-FRA-IRL-TGW"
      description: "AWS Transit Gateway between Frankfurt and Ireland"
      link_type: sd_wan  # AWS backbone, treated as SD-WAN
      bandwidth: 50000  # AWS internal bandwidth
      encryption: true
      status: active
      provider: "AWS"
      source_deployment: "eu-central-1"
      destination_deployment: "eu-west-1"
      cloud_resource_id: "tgw-attach-cross-region"
