---
apiVersion: infrahub.app/v1
kind: Object
spec:
  kind: CoreNodeTriggerRule
  data:

    - name: trigger-pod-generator-update-checksum
      branch_scope: "other_branches"
      node_kind: TopologyPod
      mutation_action: "updated"
      action: run-pod-generator
      matches:
        kind: CoreNodeTriggerAttributeMatch
        data:
          - attribute_name: checksum
            value_match: any

    - name: trigger-pod-generator-update-index
      branch_scope: "other_branches"
      node_kind: TopologyPod
      mutation_action: "updated"
      action: run-pod-generator
      matches:
        kind: CoreNodeTriggerAttributeMatch
        data:
          - attribute_name: index
            value_match: any

    - name: trigger-pod-generator-update-amount-of-spines
      branch_scope: "other_branches"
      node_kind: TopologyPod
      mutation_action: "updated"
      action: run-pod-generator
      matches:
        kind: CoreNodeTriggerAttributeMatch
        data:
          - attribute_name: amount_of_spines
            value_match: any

    - name: trigger-pod-generator-update-deployment
      branch_scope: "other_branches"
      node_kind: TopologyPod
      mutation_action: "updated"
      action: run-pod-generator
      matches:
        kind: CoreNodeTriggerAttributeMatch
        data:
          - attribute_name: deployment_type
            value_match: any

    - name: trigger-rack-generator-update-checksum
      branch_scope: "other_branches"
      node_kind: LocationRack
      mutation_action: "updated"
      action: run-rack-generator
      matches:
        kind: CoreNodeTriggerAttributeMatch
        data:
          - attribute_name: checksum
            value_match: any

    - name: trigger-rack-generator-update-index
      branch_scope: "other_branches"
      node_kind: LocationRack
      mutation_action: "updated"
      action: run-rack-generator
      matches:
        kind: CoreNodeTriggerAttributeMatch
        data:
          - attribute_name: index
            value_match: any

    - name: trigger-rack-generator-update-rack-type
      branch_scope: "other_branches"
      node_kind: LocationRack
      mutation_action: "updated"
      action: run-rack-generator
      matches:
        kind: CoreNodeTriggerAttributeMatch
        data:
          - attribute_name: rack_type
            value_match: any

    - name: trigger-rack-generator-update-templates
      branch_scope: "other_branches"
      node_kind: LocationRack
      mutation_action: "updated"
      action: run-rack-generator
      matches:
        kind: CoreNodeTriggerRelationshipMatch
        data:
          - relationship_name: fabric_templates
            peer: any
            modification_type: updated
