{#- Dell SONiC Border Leaf Configuration -#}\n! Hostname configuration\nhostname {{ hostname }}\n\n! Enable required features\nnv overlay evpn\nfeature ospf\nfeature bgp\nfeature interface-vlan\nfeature vn-segment-vlan-based\nfeature nv overlay\n\n{#- VLAN Configuration -#}\n{% for vlan in vlans %}\nvlan {{ vlan.vlan_id }}\n  name {{ vlan.name or 'VLAN_' + vlan.vlan_id|string }}\n  vn-segment {{ vlan.get('vni', vlan.vlan_id) }}\n{% endfor %}\n\n{#- All Physical Interfaces -#}\n{% for interface in interfaces %}\ninterface {{ interface.name }}\n{%- if interface.description %}\n  description {{ interface.description }}\n{%- endif %}\n{%- if interface.ip_addresses %}\n{%- for ip in interface.ip_addresses %}\n  ip address {{ ip }}\n{%- endfor %}\n{%- endif %}\n{%- if interface.vlans %}\n  switchport\n  switchport mode access\n  switchport access vlan {{ interface.vlans[0] }}\n{%- endif %}\n{%- if interface.get('ospf') %}\n  ip router ospf {{ ospf.process_id or 1 }} area {{ interface.ospf.area }}\n{%- endif %}\n  no shutdown\n!\n{% endfor %}\n\n{#- OSPF Configuration -#}\n{% for ospf_config in ospf %}\nrouter ospf {{ ospf_config.process_id or 1 }}\n  router-id {{ ospf_config.router_id.split('/')[0] }}\n  reference-bandwidth {{ ospf_config.reference_bandwidth or 100000 }}\n  passive-interface default\n{%- for interface in interfaces %}\n{%- if interface.get('ospf') %}\n  no passive-interface {{ interface.name }}\n{%- endif %}\n{%- endfor %}\n!\n{% endfor %}\n\n{#- BGP Configuration -#}\n{% for bgp_config in bgp %}\nrouter bgp {{ bgp_config.local_as.asn }}\n  router-id {{ bgp_config.router_id.address.split('/')[0] }}\n  no bgp default ipv4-unicast\n  distance bgp 20 200 200\n  maximum-paths 4 ecmp 64\n{%- for session in bgp_config.sessions %}\n  neighbor {{ session.remote_ip.address.split('/')[0] }} remote-as {{ session.remote_as.asn }}\n  neighbor {{ session.remote_ip.address.split('/')[0] }} update-source Loopback0\n  neighbor {{ session.remote_ip.address.split('/')[0] }} send-community extended\n  neighbor {{ session.remote_ip.address.split('/')[0] }} maximum-routes 0\n{%- endfor %}\n  address-family ipv4\n    redistribute connected route-map RM-CONN-2-BGP\n{%- for session in bgp_config.sessions %}\n    neighbor {{ session.remote_ip.address.split('/')[0] }} activate\n{%- endfor %}\n  address-family evpn\n{%- for session in bgp_config.sessions %}\n    neighbor {{ session.remote_ip.address.split('/')[0] }} activate\n{%- endfor %}\n!\n{% endfor %}\n\n! Configure route-maps\nroute-map RM-CONN-2-BGP permit 10\n  match interface Loopback0\n\n! End of configuration\n"